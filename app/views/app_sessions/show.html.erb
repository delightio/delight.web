<%# App Session View %>
<div class="container app-session-view" >
  <div class="row">
    <div class="span8 session-video">
          <div class="video-container">
            <!--  class="track-video" id="presentation-track-video" controls="controls" autoplay -->
            <video id="app-session-video" class="video-js vjs-delight-skin" controls preload="auto" data-gesture-track="<%= @app_session.gesture_track.presigned_read_uri %>" data-duration="<%= @app_session.duration.to_f %>" width="480" height="480">
            <source src="<%= @track.presigned_read_uri if @track and @track.presigned_read_uri %>" type='video/mp4' >
            Your browser does not support video tag.
            </video>
            <p id="browser-compatibility" style="color:white;display:none">
            You are now viewing the flash version, for full experience, please use any H264 compatible browser <a href="www.google.com/chrome" target="_blank">Google Chrome</a>,<a href="http://www.apple.com/safari/download/" target="_blank">Apple Safari 3.1+</a>,<a href="http://windows.microsoft.com/en-us/internet-explorer/products/ie/home" target="_blank">IE 9.0+</a> to watch videos.
            </p>
            
           </div>      
        
    </div>
    <div class="span4 session-meta">
      <h3>Properties</h3>
      <table class="table">
        <tr>
          <td class="meta-entity">Session:</td>
          <td class="meta-data"><%= @app_session.id %></td>
        </tr>
        <tr>
          <td class="meta-entity">Version:</td>
          <td class="meta-data"><%= @app_session.app_version %></td>
        </tr>
        <tr>
          <td class="meta-entity">Build:</td>
          <td class="meta-data"><%= @app_session.app_build %></td>
        </tr>
        <tr>
          <td class="meta-entity">Locale:</td>
          <td class="meta-data"><%= @app_session.app_locale %></td>
        </tr>
        <tr>
          <td class="meta-entity">Duration:</td>
          <td class="meta-data"><%= @app_session.duration %></td>
        </tr>
        <tr>
          <td class="meta-entity">Date:</td>
          <td class="meta-data"><%= session_time_in_words @app_session.created_at %></td>
        </tr>
        <tr>
          <td class="meta-entity">Device:</td>
          <td class="meta-data"><%= @app_session.device_hw_version %></td>
        </tr>
        <tr>
          <td class="meta-entity">Device OS:</td>
          <td class="meta-data"><%= @app_session.device_os_version %></td>
        </tr>
        <tr>
          <td class="meta-entity">Connectivity:</td>
          <td class="meta-data"><%= @app_session.app_connectivity %></td>
        </tr>
      </table>

      <hr />

      <% if @is_admin %>
        <%= link_to raw('Share'), new_invitation_path(:app_id => @app_session.app.id, :app_session_id => @app_session.id), :class => "btn btn-success", :style => "color:white", :id => "app-session-show-invite-viewer" %>
      <% end %>
      <a href="<%= @track.presigned_read_uri if @track and @track.presigned_read_uri %>" target="_blank" class="btn btn-primary">Download</a>

    </div>
  </div>
</div>
<script>

  $(function() {
    $("#app-session-show-invite-viewer").colorbox({
      iframe: true,
      transition:"none",
      width:"550px",
      height:"500px"
    });


    $(document)
      .bind('cbox_open', function() {
      $("#app-session-show-invite-viewer").text('Processing...');
    })
      .bind('cbox_complete', function() {
      $("#app-session-show-invite-viewer").text('Share');
    });
      
    if (!Modernizr.video || (Modernizr.video && !Modernizr.video.h264)) { // we have proper way to do that
      $("#browser-compatibility").show();
    }
    var $vid = $("#app-session-video");
    var vid = vjs($vid[0]);
    vid.cuepoints({url: $vid.data("gesture-track"), duration: $vid.data("duration") });
  });
</script>
